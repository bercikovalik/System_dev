<style>
    #recipe-suggestions {
        background-color: fuchsia;
    }

    .recipe-image {
    }
</style>




<h1>Recept ajánlások</h1>

<div id="recipe-suggestions" style="display: flex; gap: 20px; margin: 0 auto;justify-content:space-evenly">
    <div>RECEPT</div>
    <div>RECEPT</div>
    <div>RECEPT</div>
    <div>RECEPT</div>
    <div>RECEPT</div>
</div>

<script type="text/javascript">



    const cartItems = [];

    document.querySelectorAll('.hc-cart table tr').forEach(row => {
        const linkEl = row.querySelector('a');
        const nameEl = row.querySelector('h6');
        const quantityEl = row.querySelector('input[name="lineitemquantity"]');
        const idEl = row.querySelector('input[name="lineitemid"]');

        if (linkEl && nameEl && quantityEl && idEl) {
            const url = linkEl.getAttribute('href');
            let rewriteUrl = '';

            if (url) {

                const cleanUrl = url.split('?')[0];
                rewriteUrl = cleanUrl.split('/').filter(Boolean).pop();

            }
            const item = rewriteUrl.trim();
            cartItems.push(item);
        }
    });

    console.log("Kosár tartalma:", cartItems);
    let items = [];

    for (const x of cartItems) {
        items.push(x);
    }

    const itemsGET = items.join(',');
    console.log(itemsGET);


    $.getJSON(
        "/DesktopModules/Dnn.TegnapraKV.HelloWorld/API/Welcome/GetRecipes?RewriteURLs=" + itemsGET,
        function (result) {
            var recipes = jQuery.parseJSON(result);

            var container = $('#recipe-suggestions');
            container.empty(); 
            console.log(recipes);
            $.each(recipes, function (index, recipe) {
                
                    var recipeImage = recipe.ImageUrl ? '<img src="' + recipe.ImageUrl + '" alt="' + recipe.RecipeName + '" style="width:200px; aspect-ratio: 1/1;" />' : '<div class="no-image">Nincs kép</div>';

                    container.append(
                        '<div class="recipe-card" data-recipe-id="' + recipe.RecipeId + '">' +
                        '<div class="recipe-image" style="background-color: #eee;">' + recipeImage + '</div>' +
                        '<div class="recipe-name" style="text-align:center; margin-top:10px;">' + recipe.RecipeName + '</div>' +
                        '</div>'
                    );
                
            });
        }
    );




</script>